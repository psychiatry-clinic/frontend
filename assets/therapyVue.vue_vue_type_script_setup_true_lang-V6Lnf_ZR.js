import{_ as N}from"./AppTextarea.vue_vue_type_script_setup_true_lang-WFnUXg8-.js";import{d as B,aV as E,b8 as I,k as O,j,r as v,o as d,g as c,f as o,b as s,e as K,x as p,n as a,aX as k,aj as h,v as m}from"./index-C3CY-prX.js";import{$ as C}from"./api-DjkeVUEp.js";import{a as P,V as W}from"./VRow-BjRuvHnq.js";import{V as g}from"./VCard-B_yJTJar.js";import{V as _}from"./VCardText-SEYdbnGc.js";import{V as A}from"./VDivider-9AgVVRzw.js";import{V as R}from"./VSnackbar-BKCdwpsM.js";import{a as X}from"./VWindowItem-B3qCc_fx.js";const z={class:"text-h6"},U=B({__name:"therapyVue",props:{visit:{},psychologist:{type:Boolean}},setup(w){var $;const{t:u}=E(),t=I("userData").value;O(),j();const{visit:l,psychologist:F}=w,V=v(!1),y=v(!1),S=v(!1),f=v(($=l==null?void 0:l.therapy)==null?void 0:$.notes);function q(r){f.value=r.target.value}const b=l==null?void 0:l.active,T=async r=>{if(!b)return;console.log("save 1");const e=`/visits-edit/${t==null?void 0:t.id}/${l.id}/${l.patient.id}`;try{await C(e,{method:"POST",body:{therapyRequest:r},onResponseError({response:n}){console.log(n._data)}})==="OK"&&(S.value=r)}catch(i){console.error(i)}},x=async()=>{if(!b)return;const r=`/therapy/${t==null?void 0:t.id}/${l.id}`;try{(await C(r,{method:"POST",body:{notes:f.value,clinicId:t==null?void 0:t.clinic.id},onResponseError({response:i}){console.log(i._data)}})).success?V.value=!0:y.value=!0}catch(e){console.error(e)}};return(r,e)=>{const i=N;return d(),c(X,null,{default:o(()=>[s(W,null,{default:o(()=>[s(P,{cols:"12"},{default:o(()=>[r.visit?r.psychologist?(d(),c(g,{key:1,class:"mb-6",title:"Therapy Notes"},{default:o(()=>[s(_,null,{default:o(()=>[s(i,{modelValue:a(f),"onUpdate:modelValue":e[0]||(e[0]=n=>k(f)?f.value=n:null),label:"","auto-grow":"",rows:"3",onKeyup:q},null,8,["modelValue"])]),_:1}),s(_,null,{default:o(()=>[s(h,{onClick:x},{default:o(()=>[m(p(a(u)("Save")),1)]),_:1})]),_:1}),s(A)]),_:1})):(d(),c(g,{key:2},{default:o(()=>[s(_,{class:"d-flex gap-4"},{default:o(()=>[a(S)?(d(),c(h,{key:1,onClick:e[2]||(e[2]=n=>T(!1)),color:"success"},{default:o(()=>[m(p(a(u)("Requested")),1)]),_:1})):(d(),c(h,{key:0,onClick:e[1]||(e[1]=n=>T(!0))},{default:o(()=>[m(p(a(u)("Request Therapy Session")),1)]),_:1}))]),_:1})]),_:1})):(d(),c(g,{key:0},{default:o(()=>[s(_,null,{default:o(()=>[K("h6",z,p(a(u)("Save this visit and from `Edit Visit` request a therapy session")),1)]),_:1})]),_:1}))]),_:1})]),_:1}),s(R,{modelValue:a(V),"onUpdate:modelValue":e[3]||(e[3]=n=>k(V)?V.value=n:null),color:"success"},{default:o(()=>[m(p(a(u)(" Therapy Notes Was Saved Successfully")),1)]),_:1},8,["modelValue"]),s(R,{modelValue:a(y),"onUpdate:modelValue":e[4]||(e[4]=n=>k(y)?y.value=n:null),color:"success"},{default:o(()=>[m(p(a(u)("Error Saving Therapy Notes")),1)]),_:1},8,["modelValue"])]),_:1})}}});export{U as _};
