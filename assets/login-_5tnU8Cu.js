import{d as A,aV as B,r as i,k as P,o as f,c as _,e as l,b as s,n as e,M as w,f as t,I as h,x as p,b2 as F,aj as I,ba as L,y as M,b8 as b,b0 as $}from"./index-Zv46-Gya.js";import{_ as j}from"./AppTextField.vue_vue_type_script_setup_true_lang-DKaaay4V.js";import{a as D,b as N}from"./auth-v1-top-shape-Be0n9vOV.js";import{V}from"./VNodeRenderer-BCHLcCLJ.js";import{u as U}from"./useAbility-9qcce86u.js";import{$ as z}from"./api-CHDttjGV.js";import{a as E,b as H,V as O}from"./VCard-CiWjjGfx.js";import{V as k}from"./VCardText-CXJjmy2z.js";import{V as q}from"./VForm-Cdp_Jw3z.js";import{V as G,a as C}from"./VRow-Vam89E28.js";import"./form-D6XNUAbo.js";import"./VTextField-RrDujPJA.js";/* empty css                   */import"./VCounter-C6DrztUk.js";import"./index-DifqrChY.js";import"./index-B1MJiJKT.js";import"./VField-DpvJIASS.js";import"./easing-CjukEv2V.js";import"./VInput-CgPgm4GN.js";import"./forwardRefs-C-GTDzx5.js";import"./index-B3bPRkoL.js";import"./createSimpleFunctional-D4nPAYAv.js";import"./VAvatar-pTMjHDOt.js";import"./VImg-CJB1qqlT.js";/* empty css              */const J={class:"auth-wrapper d-flex align-center justify-center pa-4"},K={class:"position-relative my-sm-16"},Q={class:"app-logo"},W={class:"app-logo-title"},X={class:"text-h4 mb-1"},Y={class:"text-capitalize"},Z={class:"mb-0"},ee={class:"align-self-center text-warning"},se=l("h1",{class:"my-6"},null,-1),ae={key:0},oe={key:1},Be=A({__name:"login",setup(te){const{t:d}=B(),u=i(!1),m=i(!1),x=P(),T=U(),y=i({message:void 0}),v=i(),r=i({username:"",password:""});i(!1);const R=async()=>{m.value=!0;try{const a=await z("/login",{method:"POST",body:{username:r.value.username,password:r.value.password},onResponseError({response:g}){y.value.message=g._data,console.log(g._data)}}),{accessToken:o,userData:c,userAbilityRules:n}=a;b("userAbilityRules").value=n,T.update(n),b("userData").value=c,b("accessToken").value=o,await $(()=>{x.push("/patients")}),m.value=!1}catch(a){console.error(a),m.value=!1}},S=()=>{var a;(a=v.value)==null||a.validate().then(({valid:o})=>{o&&R()})};return(a,o)=>{const c=j;return f(),_("div",J,[l("div",K,[s(e(V),{nodes:("h"in a?a.h:e(w))("div",{innerHTML:e(D)}),class:"text-primary auth-v1-top-shape d-none d-sm-block"},null,8,["nodes"]),s(e(V),{nodes:("h"in a?a.h:e(w))("div",{innerHTML:e(N)}),class:"text-primary auth-v1-bottom-shape d-none d-sm-block"},null,8,["nodes"]),s(O,{class:M(["auth-card","pa-6"]),"max-width":"460"},{default:t(()=>[s(E,{class:"justify-center"},{default:t(()=>[s(H,null,{default:t(()=>[l("div",Q,[s(e(V),{nodes:e(h).app.logo},null,8,["nodes"]),l("h1",W,p(e(h).app.title),1)])]),_:1})]),_:1}),s(k,null,{default:t(()=>[l("h4",X,[l("span",Y,p(e(h).app.title)+" "+p(e(d)("Clinic Application")),1)]),l("p",Z,p(e(d)("Please sign-in to your account")),1)]),_:1}),s(k,null,{default:t(()=>[s(e(q),{ref_key:"refVForm",ref:v,onSubmit:F(S,["prevent"])},{default:t(()=>[l("p",ee,p(e(y).message),1),s(G,null,{default:t(()=>[s(C,{cols:"12"},{default:t(()=>[s(c,{modelValue:e(r).username,"onUpdate:modelValue":o[0]||(o[0]=n=>e(r).username=n),autofocus:"",label:e(d)("Username"),type:"text",placeholder:""},null,8,["modelValue","label"])]),_:1}),s(C,{cols:"12"},{default:t(()=>[s(c,{modelValue:e(r).password,"onUpdate:modelValue":o[1]||(o[1]=n=>e(r).password=n),label:e(d)("Password"),placeholder:"",type:e(u)?"text":"password","append-inner-icon":e(u)?"tabler-eye-off":"tabler-eye","onClick:appendInner":o[2]||(o[2]=n=>u.value=!e(u))},null,8,["modelValue","label","type","append-inner-icon"]),se,s(I,{block:"",type:"submit",disabled:e(m)},{default:t(()=>[e(m)?(f(),_("span",ae,[s(L,{indeterminate:"",color:"info"})])):(f(),_("span",oe,p(e(d)("Login")),1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})])])}}});export{Be as default};
